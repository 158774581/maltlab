clear;
deg = pi/180;
%---------buid scara-----------
L(1) = Link('d', 0, 'a', 0.25, 'alpha', 0, ...
    'I', [0, 0, 0.029008, 0, 0, 0], ...
    'r', [0.11652,  0,  0.02891], ...
    'm', 2.247, ...
    'Jm', 117.494618e-6, ...
    'G', 80, ...
    'B', 1.48e-3, ...
    'Tc', [0.395 -0.435], ...
    'qlim', [-90 90]*deg );

L(2) = Link('d', 0, 'a', 0.25, 'alpha', pi, ...
    'I', [0, 0, 0.079803, 0, 0, 0], ...
    'r', [0.11661,0.0001,0.08375], ...
    'm', 11.078, ...
    'Jm', 104.4268e-6, ...
    'G', 50, ...
    'B', .817e-3, ...
    'Tc', [0.126 -0.071], ...
    'qlim', [-160 160]*deg );

L(3) = Link('theta',0 ,'a', 0, 'alpha', 0,'prismatic', ...
    'I', [0, 0, 0, 0, 0, 0], ...
    'r', [0,0,0], ...
    'm', 0.664, ...
    'Jm', 0.219e-4, ...
    'G', 1.8, ...
    'B', .817e-3, ...
    'Tc', [0.126 -0.071], ...
    'qlim', [-160 160] );
L(4) = Link('d', 0, 'a', 0, 'alpha', 0, ...
    'I', [0, 0, 0.079803, 0, 0, 0], ...
    'r', [0.11661,0.0001,0.08375], ...
    'm', 11.078, ...
    'Jm', 104.4268e-6, ...
    'G', 50, ...
    'B', .817e-3, ...
    'Tc', [0.126 -0.071], ...
    'qlim', [-160 160]*deg );

scara = SerialLink(L, 'name', 'scara', ...
    'manufacturer', 'Unimation', 'ikine', 'scara', 'comment', 'viscous friction; params of 8/95');
%-----------------trajectory------------------
qz = [0 pi/3 0 0]; % zero angles, L shaped pose
qr = [0.5 pi/6 0.3 pi/6]; % ready pose, arm up
t = [0:16/36:16-15/36]; 		% create time vector
t = [0:.056:2]; 		% create time vector
[q,qd,qdd] = jtraj(qz, qr, t); % compute joint coordinate trajectory

scara.fast=0;
T=scara.fkine(q);
scara.plot(q)
tau=rne_dh(scara,q, qd, qdd);
%plot(t, tau(:,1:4)); xlabel('Time (s)'); ylabel('Joint torque (Nm)');
Qdd = scara.accel(q, qd,tau);
sum(sum(qdd-Qdd));